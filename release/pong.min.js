rock.namespace("pong");
pong.constants={LOCALE_EN:"en",RES_ID_I18N_EN:"RES_ID_I18N_EN",RES_ID_MODEL_BALL:"RES_ID_MODEL_BALL",RES_ID_MODEL_RACKET:"RES_ID_MODEL_RACKET",RES_ID_MODEL_WALL:"RES_ID_MODEL_WALL",RES_ID_AUDIO_BOUNCE_BALL:"RES_ID_AUDIO_BOUNCE_BALL",RES_ID_AUDIO_GOAL:"RES_ID_AUDIO_GOAL",BALL_TYPE:"BALL_TYPE",RACKET_TYPE:"RACKET_TYPE",WALL_TYPE:"WALL_TYPE",GOAL_AREA_TYPE:"GOAL_AREA_TYPE",RESOURCE_LOADER_WINDOW:"RESOURCE_LOADER_WINDOW",MAIN_WINDOW:"MAIN_WINDOW",PLAY_AGAIN_WINDOW:"PLAY_AGAIN_WINDOW",PONG_GAME_ENGINE_WINDOW:"PONG_GAME_ENGINE_WINDOW",
PONG_RENDERER_CONTEXT:"PONG_RENDERER_CONTEXT"};rock.namespace("pong.geometry");pong.geometry.DynamicBBOX=function(a,b,c,d){this.center=a;this.width=b;this.height=c;this.depth=d};pong.geometry.DynamicBBOX.prototype.getXMin=function(){return this.getCenter().getX()-this.width/2};pong.geometry.DynamicBBOX.prototype.getXMax=function(){return this.getCenter().getX()+this.width/2};pong.geometry.DynamicBBOX.prototype.getYMin=function(){return this.getCenter().getY()-this.height/2};
pong.geometry.DynamicBBOX.prototype.getYMax=function(){return this.getCenter().getY()+this.height/2};pong.geometry.DynamicBBOX.prototype.getZMin=function(){return this.getCenter().getZ()-this.depth/2};pong.geometry.DynamicBBOX.prototype.getZMax=function(){return this.getCenter().getZ()+this.depth/2};pong.geometry.DynamicBBOX.prototype.adjustXMin=function(a){var b=this.center;a-=this.getXMin();a=b.getX()+a;b.setX(a)};
pong.geometry.DynamicBBOX.prototype.adjustXMax=function(a){var b=this.center;a-=this.getXMax();a=b.getX()+a;b.setX(a)};pong.geometry.DynamicBBOX.prototype.getCenter=function(){return this.center};pong.geometry.DynamicBBOX.prototype.setCenter=function(a){this.center=a};pong.geometry.DynamicBBOX.prototype.getWidth=function(){return this.width};pong.geometry.DynamicBBOX.prototype.setWidth=function(a){this.width=a};pong.geometry.DynamicBBOX.prototype.getHeight=function(){return this.height};
pong.geometry.DynamicBBOX.prototype.setHeight=function(a){this.height=a};pong.geometry.DynamicBBOX.prototype.getDepth=function(){return this.depth};pong.geometry.DynamicBBOX.prototype.setDepth=function(a){this.depth=a};rock.namespace("pong.court");pong.court.PongObject=function(a,b){rock.super_(this,[a,b]);this.dynamicBBOX=new pong.geometry.DynamicBBOX(this.position,1,1,1);this.point3_ma=new rock.geometry.Point3};rock.extends_(pong.court.PongObject,rock.game.universe.Object);pong.court.PongObject.prototype.adjustXMin=function(a){this.dynamicBBOX.adjustXMin(a)};pong.court.PongObject.prototype.adjustXMax=function(a){this.dynamicBBOX.adjustXMax(a)};
pong.court.PongObject.prototype.isPongObjectOnLeft=function(a){var b=this.dynamicBBOX.getXMax();return a.getDynamicBBOX().getXMin()<b};pong.court.PongObject.prototype.isPongObjectOnRight=function(a){var b=this.dynamicBBOX.getXMin();return a.getDynamicBBOX().getXMax()>b};pong.court.PongObject.prototype.isPongObjectOnTop=function(a){var b=this.dynamicBBOX.getZMin();return a.getDynamicBBOX().getZMax()>b};
pong.court.PongObject.prototype.isPongObjectOnBottom=function(a){var b=this.dynamicBBOX.getZMax();return a.getDynamicBBOX().getZMin()<b};pong.court.PongObject.prototype.adjustPongObjectToLeft=function(a){a.adjustXMin(this.dynamicBBOX.getXMax())};pong.court.PongObject.prototype.adjustPongObjectToRight=function(a){a.adjustXMax(this.dynamicBBOX.getXMin())};
pong.court.PongObject.prototype.bounceBallOnRight=function(a){var b=a.getDynamicBBOX(),c=this.getBallHitPointDepthAxis(a,b.getXMin(),this.dynamicBBOX.getXMax()),d=b.getDepth()/2,f=c.getZ()-d,d=c.getZ()+d;if(!this.intersectDepthAxisWithRange(f,d))return!1;f=a.getPosition();f.setX(c.getX()+b.getWidth()/2);f.setZ(c.getZ());a.setAngle(this.getBallBounceAngleDepthAxis(a));return!0};
pong.court.PongObject.prototype.bounceBallOnLeft=function(a){var b=a.getDynamicBBOX(),c=this.getBallHitPointDepthAxis(a,b.getXMax(),this.dynamicBBOX.getXMin()),d=b.getDepth()/2,f=c.getZ()-d,d=c.getZ()+d;if(!this.intersectDepthAxisWithRange(f,d))return!1;f=a.getPosition();f.setX(c.getX()-b.getWidth()/2);f.setZ(c.getZ());a.setAngle(this.getBallBounceAngleDepthAxis(a));return!0};
pong.court.PongObject.prototype.bounceBallOnTop=function(a){var b=a.getDynamicBBOX(),c=this.getBallHitPointWidthAxis(a,b.getZMin(),this.dynamicBBOX.getZMax()),d=b.getWidth()/2,f=c.getX()-d,d=c.getX()+d;if(!this.intersectWidthAxisWithRange(f,d))return!1;f=a.getPosition();f.setX(c.getX());f.setZ(c.getZ()+b.getDepth()/2);a.setAngle(this.getBallBounceAngleWidthAxis(a));return!0};
pong.court.PongObject.prototype.bounceBallOnBottom=function(a){var b=a.getDynamicBBOX(),c=this.getBallHitPointWidthAxis(a,b.getZMax(),this.dynamicBBOX.getZMin()),d=b.getWidth()/2,f=c.getX()-d,d=c.getX()+d;if(!this.intersectWidthAxisWithRange(f,d))return!1;f=a.getPosition();f.setX(c.getX());f.setZ(c.getZ()-b.getDepth()/2);a.setAngle(this.getBallBounceAngleWidthAxis(a));return!0};
pong.court.PongObject.prototype.getBallHitPointDepthAxis=function(a,b,c){var d=this.point3_ma,f=a.getPosition();a=a.getAngle();var e=rock.util.GeometryUtils.degToRad(a);a=Math.cos(e);e=-Math.sin(e);b=e*b+a*f.getZ();b=(-(e*c)+b)/a;d.setX(c);d.setY(0);d.setZ(b);return d};
pong.court.PongObject.prototype.getBallHitPointWidthAxis=function(a,b,c){var d=this.point3_ma,f=a.getPosition();a=a.getAngle();var e=rock.util.GeometryUtils.degToRad(a);a=Math.cos(e);e=-Math.sin(e);b=e*f.getX()+a*b;d.setX((-(a*c)+b)/e);d.setY(0);d.setZ(c);return d};pong.court.PongObject.prototype.getBallBounceAngleDepthAxis=function(a){a=a.getAngle();return a+2*(90-a)};pong.court.PongObject.prototype.getBallBounceAngleWidthAxis=function(a){a=a.getAngle();return a+2*(180-a)};
pong.court.PongObject.prototype.intersectDepthAxisWithRange=function(a,b){var c=this.dynamicBBOX.getZMin(),d=this.dynamicBBOX.getZMax();return c<=a&&a<=d||c<=b&&b<=d||a<=c&&d<=b};pong.court.PongObject.prototype.intersectWidthAxisWithRange=function(a,b){var c=this.dynamicBBOX.getXMin(),d=this.dynamicBBOX.getXMax();return c<=a&&a<=d||c<=b&&b<=d||a<=c&&d<=b};
pong.court.PongObject.prototype.intersectWidthAxis=function(a){var b=this.dynamicBBOX.getXMin(),c=this.dynamicBBOX.getXMax(),d=a.getDynamicBBOX().getXMin();a=a.getDynamicBBOX().getXMax();return b<=d&&d<=c||b<=a&&a<=c||d<=b&&c<=a};pong.court.PongObject.prototype.getDynamicBBOX=function(){return this.dynamicBBOX};pong.court.PongObject.prototype.setDynamicBBOXWidthHeightDepth=function(a,b,c){var d=this.dynamicBBOX;d.setWidth(a);d.setHeight(b);d.setDepth(c)};
pong.court.PongObject.prototype.setDynamicBBOXCenter=function(a,b,c){var d=this.dynamicBBOX.getCenter();d.setX(a);d.setY(b);d.setZ(c)};rock.namespace("pong.court");pong.court.Ball=function(a){rock.super_(this,[pong.constants.BALL_TYPE,a]);this.angle=this.velocity=null};rock.extends_(pong.court.Ball,pong.court.PongObject);pong.court.Ball.prototype.move=function(a){this.moveStraight(a);a=this.bounceOnWalls();var b=this.bounceOnRackets();return a||b};
pong.court.Ball.prototype.moveStraight=function(a){var b=a*this.velocity,c=rock.util.GeometryUtils.degToRad(this.angle);a=Math.cos(c)*b;b*=Math.sin(c);c=this.getPosition();c.setX(c.getX()+a);c.setZ(c.getZ()+b)};pong.court.Ball.prototype.bounceOnWalls=function(){var a=this.world.getLeftWall(),b=this.world.getRightWall(),c=!1;this.isMovingLeft()&&(c=a.bounceBallOnRightIfNecessary(this));this.isMovingRight()&&(c=c||b.bounceBallOnLeftIfNecessary(this));return c};
pong.court.Ball.prototype.bounceOnRackets=function(){var a=this.world.getPlayerRacket(),b=this.world.getOpponentRacket(),c=!1;this.isMovingTop()&&(c=a.bounceBallOnBottomIfNecessary(this));this.isMovingBottom()&&(c=c||b.bounceBallOnTopIfNecessary(this));return c};
pong.court.Ball.prototype.getOpponentGoalAreaHitPosition=function(){var a=this.world,b=a.getCourtDepth(),c=a.getCourtWidth(),b=1.1*Math.sqrt(Math.pow(b,2)+Math.pow(c,2))/this.getVelocity();this.moveStraight(b);for(c=this.bounceOnWalls();c;)this.moveStraight(b),c=this.bounceOnWalls();a=a.getOpponentGoalArea();return this.getBallHitPointWidthAxis(this,this.dynamicBBOX.getZMin(),a.getDynamicBBOX().getZMax())};pong.court.Ball.prototype.isMovingLeft=function(){var a=this.angle;return 90<a&&270>a};
pong.court.Ball.prototype.isMovingRight=function(){var a=this.angle;return 0<a&&90>a||270<a&&360>a};pong.court.Ball.prototype.isMovingTop=function(){var a=this.angle;return 0<a&&180>a};pong.court.Ball.prototype.isMovingBottom=function(){var a=this.angle;return 180<a&&360>a};pong.court.Ball.prototype.initFromBallInfo=function(a){this.setVelocity(a.getVelocity());this.setAngle(a.getAngle());var b=this.getPosition();a=a.getPosition();b.setX(a.getX());b.setZ(a.getZ())};
pong.court.Ball.prototype.getVelocity=function(){return this.velocity};pong.court.Ball.prototype.setVelocity=function(a){this.velocity=a};pong.court.Ball.prototype.getAngle=function(){return this.angle};pong.court.Ball.prototype.setAngle=function(a){this.angle=rock.util.GeometryUtils.normalizeAngle(a)};rock.namespace("pong.court");pong.court.Wall=function(a){rock.super_(this,[pong.constants.WALL_TYPE,a])};rock.extends_(pong.court.Wall,pong.court.PongObject);pong.court.Wall.prototype.bounceBallOnRightIfNecessary=function(a){var b=!1;this.isPongObjectOnLeft(a)&&(b=this.bounceBallOnRight(a));return b};pong.court.Wall.prototype.bounceBallOnLeftIfNecessary=function(a){var b=!1;this.isPongObjectOnRight(a)&&(b=this.bounceBallOnLeft(a));return b};rock.namespace("pong.court");pong.court.Racket=function(a){rock.super_(this,[pong.constants.RACKET_TYPE,a]);this.MAX_DIFFERENCE=500;this.MAX_ANGLE_VARIATION=45;this.velocity=null;this.movingRight=this.movingLeft=!1;this.startingMovingTime=null};rock.extends_(pong.court.Racket,pong.court.PongObject);pong.court.Racket.prototype.resetMovement=function(){this.movingRight=this.movingLeft=!1;this.startingMovingTime=null};
pong.court.Racket.prototype.move=function(a,b,c){this.updateMovement(b,c)&&(a*=this.velocity,b&&(a=-a),b=this.position,c=b.getX(),b.setX(c+a),this.adjustPosition())};pong.court.Racket.prototype.isMoving=function(){return this.movingLeft||this.movingRight};pong.court.Racket.prototype.adjustPosition=function(){var a=this.world.getLeftWall(),b=this.world.getRightWall();a.isPongObjectOnLeft(this)&&a.adjustPongObjectToLeft(this);b.isPongObjectOnRight(this)&&b.adjustPongObjectToRight(this)};
pong.court.Racket.prototype.updateMovement=function(a,b){if(a&&b||!a&&!b)return this.movingRight=this.movingLeft=!1;this.movingLeft&&a||this.movingRight&&b||(this.startingMovingTime=Date.now());this.movingLeft=a;this.movingRight=b;if(!this.isMoving())return!1;a&&(this.movingLeft=!0);b&&(this.movingRight=!0);return!0};
pong.court.Racket.prototype.bounceBallOnTopIfNecessary=function(a){var b=!1;this.isPongObjectOnBottom(a)&&(b=this.bounceBallOnTop(a))&&(this.isMoving()&&!this.isTouchingWall())&&this.adjustBallAfterBounce(a);return b};pong.court.Racket.prototype.bounceBallOnBottomIfNecessary=function(a){var b=!1;this.isPongObjectOnTop(a)&&(b=this.bounceBallOnBottom(a))&&(this.isMoving()&&!this.isTouchingWall())&&this.adjustBallAfterBounce(a);return b};
pong.court.Racket.prototype.adjustBallAfterBounce=function(a){var b=this.startingMovingTime,c=this.MAX_DIFFERENCE,d=this.movingRight,f=this.movingLeft,b=Date.now()-b;b>c&&(b=c);var c=b*this.MAX_ANGLE_VARIATION/c,b=a.getAngle(),e=0;180<=b&&360>b&&(d?e=b+c:f&&(e=b-c),360<=e&&(e=359),180>=e&&(e=181));0<=b&&180>b&&(d?e=b-c:f&&(e=b+c),180<=e&&(e=179),0>=e&&(e=1));e=this.adjustAngleMustMoveUpperOrDown(e);a.setAngle(e)};
pong.court.Racket.prototype.adjustAngleMustMoveUpperOrDown=function(a){0<=a&&15>a&&(a=15);165<a&&180>=a&&(a=165);180<=a&&195>a&&(a=195);345<a&&360>=a&&(a=345);return a};pong.court.Racket.prototype.isTouchingWall=function(){var a=this.world,b=this.dynamicBBOX,c=a.getLeftWall().getDynamicBBOX(),a=a.getRightWall().getDynamicBBOX();return b.getXMin()==c.getXMax()||b.getXMax()==a.getXMin()?!0:!1};pong.court.Racket.prototype.getVelocity=function(){return this.velocity};
pong.court.Racket.prototype.setVelocity=function(a){this.velocity=a};rock.namespace("pong.court");pong.court.OpponentRacket=function(a){rock.super_(this,[a]);this.dummyBall=new pong.court.Ball(a);this.wasBallMovingTop=!1;this.expectedOpponentHitPoint=null};rock.extends_(pong.court.OpponentRacket,pong.court.Racket);pong.court.OpponentRacket.prototype.prepareToKick=function(a,b){this.goToHitPoint(a,b)};
pong.court.OpponentRacket.prototype.goToHitPoint=function(a,b){var c,d,f,e;c=this.dummyBall;a.isMovingBottom()&&(this.wasBallMovingTop&&(c.initFromBallInfo(a),this.expectedOpponentHitPoint=c.getOpponentGoalAreaHitPosition()),c=this.expectedOpponentHitPoint,c=c.getX(),d=this.dynamicBBOX,f=d.getWidth()/8,d=d.getCenter().getX(),e=-15>a.getDynamicBBOX().getCenter().getZ(),d<c-f&&e?this.move(b,!1,!0):d>c+f&&e?this.move(b,!0,!1):this.move(b,!1,!1));this.wasBallMovingTop=a.isMovingTop()};
pong.court.OpponentRacket.prototype.follow=function(a,b){var c=a.getDynamicBBOX(),d=this.dynamicBBOX,f=c.getCenter(),c=f.getX(),e=f.getZ(),f=d.getCenter().getX();!(-25<e)&&Math.abs(c-f)>d.getWidth()/2&&(e=d=!1,f<c?e=!0:d=!0,this.move(b,d,e))};rock.namespace("pong.court");pong.court.GoalArea=function(a){rock.super_(this,[pong.constants.GOAL_AREA_TYPE,a])};rock.extends_(pong.court.GoalArea,pong.court.PongObject);pong.court.GoalArea.prototype.hasScoredGoalTop=function(a){return this.isPongObjectOnBottom(a)};pong.court.GoalArea.prototype.hasScoredGoalBottom=function(a){return this.isPongObjectOnTop(a)};rock.namespace("pong.court");
pong.court.Court=function(a){rock.super_(this,arguments);this.opponentGoalArea=this.playerGoalArea=this.rightWall=this.leftWall=this.opponentRacket=this.playerRacket=this.ball=null;this.isMovingPlayerRacketRight=this.isMovingPlayerRacketLeft=!1;this.currentTime=this.lastTime=null;this.timeVariation=-1;this.PLAYER_RACKET_VELOCITY=0.045;this.OPPONENT_RACKET_VELOCITY=0.03;this.BALL_VELOCITY=0.05;this.WALL_DEPTH=100;this.RACKET_WIDTH=10;this.DEFAULT_SIZE_VALUE=1;this.COURT_WIDTH=60;this.COURT_DEPTH=this.WALL_DEPTH;
this.opponentAnnotation=this.playerAnnotation=0;this.MAX_ANNOTATION=3;this.CELEBRATION_TIME=2300;this.createPongObjects()};rock.extends_(pong.court.Court,rock.game.universe.World);pong.court.Court.NO_WINNER=0;pong.court.Court.PLAYER_WINNER=1;pong.court.Court.OPPONENT_WINNER=2;
pong.court.Court.prototype.createPongObjects=function(){var a=this.WALL_DEPTH,b=this.RACKET_WIDTH,c=this.DEFAULT_SIZE_VALUE,d=this.COURT_WIDTH,f=new pong.court.Ball(this);f.setVelocity(this.BALL_VELOCITY);f.setDynamicBBOXWidthHeightDepth(c,c,c);var e=new pong.court.Racket(this);e.setVelocity(this.PLAYER_RACKET_VELOCITY);e.setDynamicBBOXWidthHeightDepth(b,c,c);var g=new pong.court.OpponentRacket(this);g.setVelocity(this.OPPONENT_RACKET_VELOCITY);g.setDynamicBBOXWidthHeightDepth(b,c,c);b=new pong.court.Wall(this);
b.setDynamicBBOXWidthHeightDepth(c,c,a);var h=new pong.court.Wall(this);h.setDynamicBBOXWidthHeightDepth(c,c,a);a=new pong.court.GoalArea(this);a.setDynamicBBOXWidthHeightDepth(d,c,c);var j=new pong.court.GoalArea(this);j.setDynamicBBOXWidthHeightDepth(d,c,c);this.ball=f;this.playerRacket=e;this.opponentRacket=g;this.leftWall=b;this.rightWall=h;this.playerGoalArea=a;this.opponentGoalArea=j;this.hasScored=!1;this.scoreTime=null};
pong.court.Court.prototype.prepareGame=function(){this.resetAnnotation();this.resetGameObjects();this.resetTimes();this.resetMovement()};pong.court.Court.prototype.resetAnnotation=function(){this.opponentAnnotation=this.playerAnnotation=0};
pong.court.Court.prototype.resetGameObjects=function(){var a=this.COURT_DEPTH/2,b=this.DEFAULT_SIZE_VALUE/2,c=a+b,d=this.COURT_WIDTH/2+b,a=a+b;this.resetBall();this.getPlayerRacket().setDynamicBBOXCenter(0,0,c);this.getOpponentRacket().setDynamicBBOXCenter(0,0,-c);this.getLeftWall().setDynamicBBOXCenter(-d,0,0);this.getRightWall().setDynamicBBOXCenter(d,0,0);this.getPlayerGoalArea().setDynamicBBOXCenter(0,0,a);this.getOpponentGoalArea().setDynamicBBOXCenter(0,0,-a)};
pong.court.Court.prototype.resetBall=function(){var a=this.getBall();a.setDynamicBBOXCenter(1,0,0);var b=rock.util.JsUtils.getRandomNumber(70,110);a.setAngle(b);this.hasScored=!1};pong.court.Court.prototype.resetTimes=function(){this.currentTime=this.lastTime=null;this.timeVariation=-1};pong.court.Court.prototype.resetMovement=function(){this.isMovingPlayerRacketRight=this.isMovingPlayerRacketLeft=!1};
pong.court.Court.prototype.runLogic=function(a){this.updateTime();this.isCelebrating(a)||(this.updatePlayerRacket(),this.updateOpponentRacket(),this.updateBall(a),this.isGoal(a))};pong.court.Court.prototype.updateTime=function(){this.lastTime=this.currentTime;var a=Date.now();null==this.lastTime&&(this.lastTime=a);this.timeVariation=a-this.lastTime;this.currentTime=a};pong.court.Court.prototype.updatePlayerRacket=function(){this.playerRacket.move(this.timeVariation,this.isMovingPlayerRacketLeft,this.isMovingPlayerRacketRight)};
pong.court.Court.prototype.updateOpponentRacket=function(){this.opponentRacket.prepareToKick(this.ball,this.timeVariation)};pong.court.Court.prototype.updateBall=function(a){this.ball.move(this.timeVariation)&&a.getEvents().addValue(pong.engine.PongState.BALL_BOUND_EVENT)};
pong.court.Court.prototype.isGoal=function(a){var b=this.ball,c=!1;this.playerGoalArea.hasScoredGoalBottom(b)&&(this.opponentAnnotation++,c=!0);this.opponentGoalArea.hasScoredGoalTop(b)&&(this.playerAnnotation++,c=!0);c&&(a.getEvents().addValue(pong.engine.PongState.GOAL_EVENT),this.hasScored=!0,this.scoreTime=Date.now())};
pong.court.Court.prototype.isCelebrating=function(a){var b;return this.hasScored?(b=Date.now(),b-this.scoreTime>this.CELEBRATION_TIME?(this.resetBall(),this.checkWinner(a),this.hasScored=!1):!0):!1};pong.court.Court.prototype.checkWinner=function(a){var b=this.getWinner();b===pong.court.Court.PLAYER_WINNER?a.getEvents().addValue(pong.engine.PongState.PLAYER_WINS_EVENT):b===pong.court.Court.OPPONENT_WINNER&&a.getEvents().addValue(pong.engine.PongState.PLAYER_LOST_EVENT)};
pong.court.Court.prototype.getWinner=function(){var a=this.MAX_ANNOTATION;return this.playerAnnotation==a?pong.court.Court.PLAYER_WINNER:this.opponentAnnotation==a?pong.court.Court.OPPONENT_WINNER:pong.court.Court.NO_WINNER};pong.court.Court.prototype.getBall=function(){return this.ball};pong.court.Court.prototype.setBall=function(a){this.ball=a};pong.court.Court.prototype.getPlayerRacket=function(){return this.playerRacket};
pong.court.Court.prototype.setPlayerRacket=function(a){this.playerRacket=a};pong.court.Court.prototype.getOpponentRacket=function(){return this.opponentRacket};pong.court.Court.prototype.setOpponentRacket=function(a){this.opponentRacket=a};pong.court.Court.prototype.getLeftWall=function(){return this.leftWall};pong.court.Court.prototype.setLeftWall=function(a){this.leftWall=a};pong.court.Court.prototype.getRightWall=function(){return this.rightWall};
pong.court.Court.prototype.setRightWall=function(a){this.rightWall=a};pong.court.Court.prototype.getPlayerGoalArea=function(){return this.playerGoalArea};pong.court.Court.prototype.setPlayerGoalArea=function(a){this.playerGoalArea=a};pong.court.Court.prototype.getOpponentGoalArea=function(){return this.opponentGoalArea};pong.court.Court.prototype.setOpponentGoalArea=function(a){this.opponentGoalArea=a};pong.court.Court.prototype.getIsMovingPlayerRacketLeft=function(){return this.isMovingPlayerRacketLeft};
pong.court.Court.prototype.setIsMovingPlayerRacketLeft=function(a){this.isMovingPlayerRacketLeft=a};pong.court.Court.prototype.getIsMovingPlayerRacketRight=function(){return this.isMovingPlayerRacketRight};pong.court.Court.prototype.setIsMovingPlayerRacketRight=function(a){this.isMovingPlayerRacketRight=a};pong.court.Court.prototype.getPlayerAnnotation=function(){return this.playerAnnotation};pong.court.Court.prototype.getOpponentAnnotation=function(){return this.opponentAnnotation};
pong.court.Court.prototype.getCourtWidth=function(){return this.COURT_WIDTH};pong.court.Court.prototype.getCourtDepth=function(){return this.COURT_DEPTH};rock.namespace("pong.graphics.scene");pong.graphics.scene.PongObjectRepresentation=function(a,b){rock.super_(this,arguments)};rock.extends_(pong.graphics.scene.PongObjectRepresentation,rock.game.graphics.scene.Representation);pong.graphics.scene.PongObjectRepresentation.prototype.update=function(){this.updateRenderablesModelMatrixFromPosition()};rock.namespace("pong.graphics.scene");pong.graphics.scene.BallRepresentation=function(a,b){rock.super_(this,arguments)};rock.extends_(pong.graphics.scene.BallRepresentation,pong.graphics.scene.PongObjectRepresentation);pong.graphics.scene.BallRepresentation.prototype.updateModel=function(){this.model=this.representationAttendant.getRepository().getModel(pong.constants.BALL_TYPE)};
pong.graphics.scene.BallRepresentation.prototype.createRenderables=function(){var a=this.representationAttendant,b=a.getRenderEngine(),a=a.getRepository(),b=b.createRenderable(this.model);b.setModelAdapter(a.getAdapter(pong.constants.BALL_TYPE));this.renderables.addValue(b)};rock.namespace("pong.graphics.scene");pong.graphics.scene.WallRepresentation=function(a,b){rock.super_(this,arguments)};rock.extends_(pong.graphics.scene.WallRepresentation,pong.graphics.scene.PongObjectRepresentation);pong.graphics.scene.WallRepresentation.prototype.updateModel=function(){this.model=this.representationAttendant.getRepository().getModel(pong.constants.WALL_TYPE)};
pong.graphics.scene.WallRepresentation.prototype.createRenderables=function(){var a=this.representationAttendant,b=a.getRenderEngine(),a=a.getRepository(),b=b.createRenderable(this.model);b.setModelAdapter(a.getAdapter(pong.constants.WALL_TYPE));this.renderables.addValue(b)};rock.namespace("pong.graphics.scene");pong.graphics.scene.RacketRepresentation=function(a,b){rock.super_(this,arguments)};rock.extends_(pong.graphics.scene.RacketRepresentation,pong.graphics.scene.PongObjectRepresentation);pong.graphics.scene.RacketRepresentation.prototype.updateModel=function(){this.model=this.representationAttendant.getRepository().getModel(pong.constants.RACKET_TYPE)};
pong.graphics.scene.RacketRepresentation.prototype.createRenderables=function(){var a=this.representationAttendant,b=a.getRenderEngine(),a=a.getRepository(),b=b.createRenderable(this.model);b.setModelAdapter(a.getAdapter(pong.constants.RACKET_TYPE));this.renderables.addValue(b)};rock.namespace("pong.engine");pong.engine.RepresentationAttendant=function(a,b){rock.super_(this,arguments);this.representations_ma=new rock.js.Array};rock.extends_(pong.engine.RepresentationAttendant,rock.game.engine.RepresentationAttendant);
pong.engine.RepresentationAttendant.prototype.createAdapters=function(){var a=this.renderEngine,b=this.repository,c=b.getModel(pong.constants.BALL_TYPE),c=a.createAdapter(c);c.build();b.addAdapter(pong.constants.BALL_TYPE,c);c=b.getModel(pong.constants.RACKET_TYPE);c=a.createAdapter(c);c.build();b.addAdapter(pong.constants.RACKET_TYPE,c);c=b.getModel(pong.constants.WALL_TYPE);a=a.createAdapter(c);a.build();b.addAdapter(pong.constants.WALL_TYPE,a)};
pong.engine.RepresentationAttendant.prototype.createRepresentation=function(a){var b=null;switch(a.getType()){case pong.constants.BALL_TYPE:b=new pong.graphics.scene.BallRepresentation(this,a);break;case pong.constants.RACKET_TYPE:b=new pong.graphics.scene.RacketRepresentation(this,a);break;case pong.constants.WALL_TYPE:b=new pong.graphics.scene.WallRepresentation(this,a)}return b};
pong.engine.RepresentationAttendant.prototype.getRepresentations=function(a){var b=a.getBall(),c=a.getPlayerRacket(),d=a.getOpponentRacket(),f=a.getLeftWall();a=a.getRightWall();var e=this.representations_ma;e.clear();e.addValue(b.getRepresentation());e.addValue(c.getRepresentation());e.addValue(d.getRepresentation());e.addValue(f.getRepresentation());e.addValue(a.getRepresentation());return e};rock.namespace("pong.engine");pong.engine.PongState=function(){rock.super_(this);this.winner=!1};rock.extends_(pong.engine.PongState,rock.game.engine.GameState);pong.engine.PongState.BALL_BOUND_EVENT=1001;pong.engine.PongState.GOAL_EVENT=1002;pong.engine.PongState.PLAYER_WINS_EVENT=1003;pong.engine.PongState.PLAYER_LOST_EVENT=1004;pong.engine.PongState.prototype.getWinner=function(){return this.winner};pong.engine.PongState.prototype.setWinner=function(a){this.winner=a};rock.namespace("pong.engine");pong.engine.PongDirector=function(a){rock.super_(this,arguments)};rock.extends_(pong.engine.PongDirector,rock.game.engine.GameDirector);pong.engine.PongDirector.prototype.start=function(){var a=this.windowSystem.getWindow(pong.constants.PONG_GAME_ENGINE_WINDOW);this.windowSystem.setCurrentWindow(a)};pong.engine.PongDirector.prototype.resume=function(){};pong.engine.PongDirector.prototype.load=function(){};pong.engine.PongDirector.prototype.save=function(){};
pong.engine.PongDirector.prototype.handleGameState=function(a){var b,c;a.getResult()==rock.game.engine.GameState.FINISH_GAME&&(b=this.windowSystem,c=b.getWindow(pong.constants.PLAY_AGAIN_WINDOW),a.getWinner()?c.setTitle(!0):c.setTitle(!1),b.setCurrentWindow(c))};rock.namespace("pong.engine");pong.engine.PongEngine=function(a,b){var c=new rock.game.graphics.engine.webgl.RockBasicRenderEngine(a);c.setClearColor(rock.graphics.Color.BLACK.clone());var d=new pong.engine.RepresentationAttendant(c,b);rock.super_(this,[c,d]);this.CAMERA_POSITION=new rock.geometry.Point3(0,50,80);this.CAMERA_CENTER=new rock.geometry.Point3(0,0,0);this.CAMERA_LOOKUP=new rock.geometry.Vector3(0,1,0);this.FOV=60;this.ZNEAR=0.1;this.ZFAR=200;this.pongState=new pong.engine.PongState};
rock.extends_(pong.engine.PongEngine,rock.game.engine.GameEngine);pong.engine.PongEngine.prototype.prepareGame=function(){this.createLighting();this.createCamera();this.createCourt();this.createAdapters();this.createRepresentations()};
pong.engine.PongEngine.prototype.createLighting=function(){var a=new rock.game.graphics.lighting.DirectionalLight;a.setPosition(0,0,1);a.setAmbient(255,255,255);a.setDiffuse(255,255,255);a.setSpecular(255,255,255);var b=new rock.game.graphics.scene.DirectionalLighting;b.addLight(a);this.lighting=b};
pong.engine.PongEngine.prototype.createCamera=function(){var a=this.window.getWindowSystem().getAspectRatio();this.camera=new rock.game.graphics.scene.Camera(this.CAMERA_POSITION,this.CAMERA_CENTER,this.CAMERA_LOOKUP,this.FOV,a,this.ZNEAR,this.ZFAR)};pong.engine.PongEngine.prototype.createCourt=function(){this.world=new pong.court.Court(this)};pong.engine.PongEngine.prototype.createAdapters=function(){this.representationAttendant.createAdapters()};
pong.engine.PongEngine.prototype.createRepresentations=function(){var a=this.world,b=this.representationAttendant,c=a.getBall(),d=b.createRepresentation(c);c.setRepresentation(d);c=a.getPlayerRacket();d=b.createRepresentation(c);c.setRepresentation(d);c=a.getOpponentRacket();d=b.createRepresentation(c);c.setRepresentation(d);c=a.getLeftWall();d=b.createRepresentation(c);c.setRepresentation(d);a=a.getRightWall();b=b.createRepresentation(a);a.setRepresentation(b)};
pong.engine.PongEngine.prototype.initGame=function(){this.world.prepareGame();this.updateScore();this.pongState.setResult(rock.game.engine.GameState.IS_RUNNING)};pong.engine.PongEngine.prototype.runLogic=function(){var a=this.pongState;a.clearEvents();this.world.runLogic(a);this.processEvents();return a};
pong.engine.PongEngine.prototype.processEvents=function(){var a=this.pongState,b=a.getEvents(),c,d,f=b.getLength();for(c=0;c<f;c++)d=b.getValue(c),d===pong.engine.PongState.BALL_BOUND_EVENT?(d=this.window.getApplication().getRepository(),d=d.getAudio(pong.constants.RES_ID_AUDIO_BOUNCE_BALL),d.play()):d===pong.engine.PongState.GOAL_EVENT?(this.updateScore(),d=this.window.getApplication().getRepository(),d=d.getAudio(pong.constants.RES_ID_AUDIO_GOAL),d.play()):d===pong.engine.PongState.PLAYER_WINS_EVENT?
(a.setResult(rock.game.engine.GameState.FINISH_GAME),a.setWinner(!0)):d===pong.engine.PongState.PLAYER_LOST_EVENT&&(a.setResult(rock.game.engine.GameState.FINISH_GAME),a.setWinner(!1))};pong.engine.PongEngine.prototype.onKeyDown=function(a){a=a.getKey();this.updateMovementOnKeyEvent(a,!0)};pong.engine.PongEngine.prototype.onKeyUp=function(a){a=a.getKey();this.updateMovementOnKeyEvent(a,!1)};
pong.engine.PongEngine.prototype.updateMovementOnKeyEvent=function(a,b){var c=this.world;65==a||37==a?c.setIsMovingPlayerRacketLeft(b):(68==a||39==a)&&c.setIsMovingPlayerRacketRight(b)};pong.engine.PongEngine.prototype.updateScore=function(){var a=this.world,b=a.getPlayerAnnotation(),a=a.getOpponentAnnotation();this.window.updateScore(b,a)};pong.engine.PongEngine.prototype.onWindowActivate=function(){this.initGame();this.window.start()};pong.engine.PongEngine.prototype.onWindowDeactivate=function(){this.window.stop()};rock.namespace("pong.window");pong.window.MainWindow=function(a,b){rock.super_(this,arguments);this.addComponents()};rock.extends_(pong.window.MainWindow,rock.game.GameWindow);
pong.window.MainWindow.prototype.addComponents=function(){var a=new rock.graphics.Font("Arial",36),a=new rock.window.component.html.HTMLLabel(this,"TITLE",!0,a,rock.graphics.Color.WHITE.clone());a.id="titleLabel";a.setX(205);a.setY(150);this.addComponent(a);a=new rock.window.component.Button(this,"START_GAME_BUTTON",!0);a.setId("startGameButton");a.setX(200);a.setY(250);a.setWidth(200);a.setHeight(50);a.addEventListener(rock.constants.ROCK_EVENT_CLICK,rock.createEventHandler(this,this.handleOnStartGameButtonClick));
this.addComponent(a);a=new rock.graphics.Font("Arial",14);a=new rock.window.component.html.HTMLLabel(this,"CONTROLS",!0,a,rock.graphics.Color.WHITE.clone());a.id="controlsLabel";a.setX(160);a.setY(400);this.addComponent(a)};pong.window.MainWindow.prototype.handleOnStartGameButtonClick=function(){this.gameDirector.start()};rock.namespace("pong.window");pong.window.PlayAgainWindow=function(a,b){rock.super_(this,arguments);this.defeatLabel=this.victoryLabel=null;this.addComponents()};rock.extends_(pong.window.PlayAgainWindow,rock.game.GameWindow);
pong.window.PlayAgainWindow.prototype.addComponents=function(){var a=new rock.graphics.Font("Arial",36),b=new rock.window.component.html.HTMLLabel(this,"VICTORY",!0,a,rock.graphics.Color.WHITE.clone());b.id="victoryLabel";b.setX(230);b.setY(150);this.victoryLabel=b;a=new rock.window.component.html.HTMLLabel(this,"DEFEAT",!0,a,rock.graphics.Color.WHITE.clone());a.id="defeatLabel";a.setX(230);a.setY(150);this.defeatLabel=a;a=new rock.window.component.Button(this,"PLAY_AGAIN_GAME_BUTTON",!0);a.setId("playAgainButton");
a.setX(200);a.setY(250);a.setWidth(200);a.setHeight(50);a.addEventListener(rock.constants.ROCK_EVENT_CLICK,rock.createEventHandler(this,this.handleOnStartGameButtonClick));this.addComponent(a)};pong.window.PlayAgainWindow.prototype.handleOnStartGameButtonClick=function(){this.gameDirector.start()};pong.window.PlayAgainWindow.prototype.setTitle=function(a){var b=this.victoryLabel,c=this.defeatLabel;this.removeComponent(c);this.removeComponent(b);a?this.addComponent(b):this.addComponent(c)};rock.namespace("pong.window");pong.window.PongGameEngineWindow=function(a,b){var c=a.getGraphicsEngine(),d=a.getApplication().getRepository(),c=new pong.engine.PongEngine(c,d);rock.super_(this,[a,b,c]);this.scoreLabel=null;this.createComponents();c.prepareGame()};rock.extends_(pong.window.PongGameEngineWindow,rock.game.GameEngineWindow);
pong.window.PongGameEngineWindow.prototype.createComponents=function(){var a=new rock.graphics.Font("Arial",28),a=new rock.window.component.html.HTMLLabel(this,"",!1,a,rock.graphics.Color.WHITE.clone());a.id="scoreLabel";a.setX(500);a.setY(30);this.addComponent(a);this.scoreLabel=a};pong.window.PongGameEngineWindow.prototype.updateScore=function(a,b){this.scoreLabel.setText(a+" - "+b)};rock.namespace("pong");pong.Pong=function(a,b){var c=new rock.app.InitApplicationParams(a,600,500,rock.constants.CONTEXT_WEBGL,b);rock.super_(this,[c])};rock.extends_(pong.Pong,rock.game.Game);pong.Pong.prototype.start=function(){this.addPongGameStyle();this.initResources()};
pong.Pong.prototype.addPongGameStyle=function(){var a=new rock.window.style.Style("PONG_GAME_STYLE_ID");a.addColor(rock.window.style.StyleManager.WINDOW_BACKGROUND_COLOR,new rock.graphics.Color(0,0,0));a.addColor(rock.window.style.StyleManager.COMPONENT_BACKGROUND_COLOR,new rock.graphics.Color(0,0,0));a.addColor(rock.window.style.StyleManager.COMPONENT_COLOR,new rock.graphics.Color(255,255,255));a.addColor(rock.window.style.StyleManager.COMPONENT_COLOR_2,new rock.graphics.Color(50,50,50));a.addColor(rock.window.style.StyleManager.COMPONENT_FONT_COLOR,
new rock.graphics.Color(255,255,255));a.addFont(rock.window.style.StyleManager.COMPONENT_FONT,new rock.graphics.Font(rock.constants.DEFAULT_FONT_TYPE,20));var b=this.styleManager;b.addStyle(a);b.setCurrentStyle("PONG_GAME_STYLE_ID")};
pong.Pong.prototype.initResources=function(){var a=new rock.window.ResourceLoaderWindow(this.windowSystem);this.windowSystem.registerWindow(pong.constants.RESOURCE_LOADER_WINDOW,a);this.windowSystem.setCurrentWindow(a);var b=this.urlResources,c=[];c.push(new rock.resource.loader.ResourceLoaderElement(pong.constants.RES_ID_I18N_EN,rock.constants.RESOURCE_TYPE_JSON,new rock.network.HTTPRequestParams(b+"i18n/en.json",null,null)));var d=b+"model/";c.push(new rock.resource.loader.ResourceLoaderElement(pong.constants.RES_ID_MODEL_BALL,
rock.constants.RESOURCE_TYPE_JSON,new rock.network.HTTPRequestParams(d+"ball.json",null,null)));c.push(new rock.resource.loader.ResourceLoaderElement(pong.constants.RES_ID_MODEL_RACKET,rock.constants.RESOURCE_TYPE_JSON,new rock.network.HTTPRequestParams(d+"racket.json",null,null)));c.push(new rock.resource.loader.ResourceLoaderElement(pong.constants.RES_ID_MODEL_WALL,rock.constants.RESOURCE_TYPE_JSON,new rock.network.HTTPRequestParams(d+"wall.json",null,null)));b+="audio/";c.push(new rock.resource.loader.ResourceLoaderElement(pong.constants.RES_ID_AUDIO_BOUNCE_BALL,
rock.constants.RESOURCE_TYPE_AUDIO,new rock.network.HTTPRequestParams(b+"bounceBall.wav",null,null)));c.push(new rock.resource.loader.ResourceLoaderElement(pong.constants.RES_ID_AUDIO_GOAL,rock.constants.RESOURCE_TYPE_AUDIO,new rock.network.HTTPRequestParams(b+"goal.wav",null,null)));a.addEventListener(rock.resource.event.ResourceWindowCompleteEvent.RESOURCE_WINDOW_COMPLETE,rock.createEventHandler(this,this.onResourceLoaderWindowComplete));a.loadResources(c)};
pong.Pong.prototype.onResourceLoaderWindowComplete=function(a){var b=a.getSource().getResourceLoaderManager();if(b.hasErrors())throw new rock.error.RockError(this.resourceManager.getString("ERROR_LOADING_RESOURCES"));a=this.repository;var c=b.getLoadedResource(pong.constants.RES_ID_I18N_EN).getValue();this.resourceManager.loadStrings(c);c=this.getModel(b,a,pong.constants.RES_ID_MODEL_BALL);a.addModel(pong.constants.BALL_TYPE,c);c=this.getModel(b,a,pong.constants.RES_ID_MODEL_RACKET);a.addModel(pong.constants.RACKET_TYPE,
c);c=this.getModel(b,a,pong.constants.RES_ID_MODEL_WALL);a.addModel(pong.constants.WALL_TYPE,c);c=b.getLoadedResource(pong.constants.RES_ID_AUDIO_BOUNCE_BALL).getValue();a.addAudio(pong.constants.RES_ID_AUDIO_BOUNCE_BALL,c);b=b.getLoadedResource(pong.constants.RES_ID_AUDIO_GOAL).getValue();a.addAudio(pong.constants.RES_ID_AUDIO_GOAL,b);a=this.windowSystem;var d=new pong.engine.PongDirector(a),b=new pong.window.MainWindow(this.windowSystem,d),c=new pong.window.PlayAgainWindow(this.windowSystem,d),
d=new pong.window.PongGameEngineWindow(this.windowSystem,d);a.registerWindow(pong.constants.MAIN_WINDOW,b);a.registerWindow(pong.constants.PLAY_AGAIN_WINDOW,c);a.registerWindow(pong.constants.PONG_GAME_ENGINE_WINDOW,d);a.setCurrentWindow(b)};pong.Pong.prototype.getModel=function(a,b,c){a=a.getLoadedResource(c).getValue();return rock.game.graphics.model.JSONModelUtils.createPhongModelGroup(a).getModels()[0]};
